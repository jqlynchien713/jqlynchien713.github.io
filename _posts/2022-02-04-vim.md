---
layout: post
title: 30 å¤©å¾ VScode åˆ° Vim
date: 2022-02-04 12:25 +0800
category: update cli
tag: vim cli
---

2021 å¹´æœ€å¤§çš„è½‰è®Šæ‡‰è©²å°±æ˜¯æ¥è§¸åˆ°äº†ç¾åœ¨çš„ç·¨è¼¯å™¨ä¹‹ç¥ï¼Œå¹´åˆçš„æ™‚å€™ä¸Šäº†è³‡ç§‘ç³»è”¡éŠ˜å³°è€å¸«é–‹çš„ç¶²è·¯æœç´¢èˆ‡æ¢å‹˜ï¼Œç¬¬ä¸€æ¬¡çœ‹åˆ° Vim é€™å€‹ç·¨è¼¯å™¨ï¼Œé‚„æœ‰è€å¸«è·Ÿé¬¼ä¸€æ¨£çš„æ“ä½œï¼Œè®“æˆ‘é»˜é»˜ä¸‹å®šæ±ºå¿ƒè¦å‘è€å¸«çœ‹é½Šï¼ˆé€™å ‚èª²åˆæ˜¯å¦ä¸€å€‹å……å¯¦çš„æ•…äº‹äº†ï¼‰ï¼›ä¸éè‡ªå·±ä¸‹å»å­¸çœŸçš„é–€æª»å¤ªé«˜ï¼Œåœ¨å»å¹´å››äº”æœˆä¹‹å¾Œå°±è¢«æˆ‘æš«æ™‚æ“±ç½®åœ¨ä¸€é‚Šäº†ï¼Œç›´åˆ°äº”æœˆæ‰¾åˆ°å¯¦ç¿’ï¼Œä¸ƒæœˆæ­£å¼åˆ°å…¬å¸ä¸Šç­ä¹‹å¾Œç™¼ç¾è€å¤©ï¼Œå¹¾ä¹ä¸€åŠçš„åŒäº‹éƒ½ç”¨ Vim åœ¨é–‹ç™¼ï¼ˆåŒ…æ‹¬è€é—†æœ¬äººï¼‰ï¼Œå†åŠ ä¸ŠæŸå€‹é€±äº”çš„å¿«æ¨‚åˆ†äº«æœƒï¼Œæœ‰ä½åŒäº‹åˆ†äº«äº†ä»–æ˜¯æ€éº¼å¾ VScode è½‰æ›åˆ° Vim ä¸Šçš„ï¼Œæˆ‘æ‰çœŸæ­£ä¸‹å®šæ±ºå¿ƒå»æŠŠ Vim å­¸å¥½ï¼ˆç•¢ç«Ÿå‡ç¢©ä¸€çš„æš‘å‡ä¹Ÿæ˜¯çœŸçš„å¾ˆé–’æ²’éŒ¯ï¼‰

## Vim åŸºæœ¬æ“ä½œ
æ‰€æœ‰åŸºæœ¬æ“ä½œæˆ‘éƒ½æ˜¯çœ‹[é€™çµ„](https://www.youtube.com/watch?v=LQVriYE3kxk&list=PLBd8JGCAcUAH56L2CYF7SmWJYKwHQYUDI)æ•™å­¸å½±ç‰‡å­¸çš„ï¼Œå†æ­é…è”¡è€å¸«åœ¨èª²å ‚ä¸Šä»‹ç´¹ vgod çš„ [vim é…ç½®](https://github.com/vgod/vimrc)å’Œ [cheatsheet](https://blog.vgod.tw/2009/12/08/vim-cheat-sheet-for-programmers/)ï¼Œå¦‚ä¸‹åœ–ã€‚

![](/assets/img/vim-cheat-sheet-full.png)

åŸºæœ¬ä¸Šå¦‚æœæ¯å¤©éƒ½æœ‰åœ¨å¯«ç¨‹å¼ï¼Œæ¯å¤©éƒ½é€¼è‡ªå·±ä½¿ç”¨ Vim çš„è©±ï¼Œå¤§æ¦‚åå¹¾å¤©ä¹‹å¾Œå°±èƒ½å¤ ç†Ÿæ‚‰åŸºæœ¬çš„æ“ä½œï¼Œæ¥ä¸‹ä¾†å°±æ˜¯è™•ç†è¨­å®šæª”èˆ‡å¤–æ›çš„éƒ¨åˆ†ã€‚ç•¶åˆæˆ‘åœ¨è¨­å®šæ™‚ä¹Ÿæ˜¯æå¾—å¾ˆé ­ç—›ï¼Œå› ç‚ºæœ€ç•¶åˆä»€éº¼éƒ½é‚„ä¸æ‡‚æ™‚å°±ç›´æ¥ä½¿ç”¨ vgod çš„è¨­å®šæª”ï¼Œå°è‡´æ“ä½œçœŸçš„ä¸Šæ‰‹ä¹‹å¾Œå¾ˆå¤šè¨­å®šå…¶å¯¦ä¸æ˜¯æˆ‘è¦çš„ï¼Œæ–¼æ˜¯æœ€å¾Œæˆ‘æŠŠè¨­å®šæª”å…¨éƒ¨åˆªæ‰ï¼Œé€£ Vim ä¹Ÿé‡æ–°å®‰è£ï¼Œæ‰çœŸæ­£é–‹å§‹é‡æ–°è¨­å®šæˆ‘çš„ Vimã€‚

## è£å¤–æ›å›‰ï¼
é›–ç„¶å¾ˆåƒå¹¹è©±ï¼Œä½†åœ¨è£å¤–æ›çš„å‰ææ˜¯è¦**ææ¸…æ¥šè‡ªå·±æƒ³è¦çš„åŠŸèƒ½åˆ°åº•æœ‰ä»€éº¼**ï¼Œä¸ç„¶è·Ÿè‘—å¤§å®¶ä¸€èµ·äº‚è£åˆ°æœ€å¾Œæœ‰äº›åŠŸèƒ½ä¹Ÿè¨±åˆ°æ­»éƒ½ä¸æœƒç”¨åˆ°ã€‚åƒåœ¨å‰›åˆ‡æ›åˆ° Vim ä¹‹å‰ï¼Œæˆ‘æ‰é«”æœƒåˆ° VScode ä¸Šçš„ `Cmd+P` é€™å€‹åŠŸèƒ½æœ‰å¤šæ–¹ä¾¿ï¼Œå¯ä»¥ä¸ç”¨å¾å´é‚Šçš„æª”æ¡ˆæ¬„ä¸€å€‹ä¸€å€‹è³‡æ–™å¤¾æ…¢æ…¢æ‰¾æª”æ¡ˆï¼›åƒæ˜¯é€™æ¨£å­çš„æ€è€ƒæ–¹å¼ï¼Œå¯ä»¥æ›´å¿«æ‰¾åˆ°æƒ³è¦ä¸¦ä¸”éœ€è¦çš„å¤–æ›ï¼Œæ‰€ä»¥ä¹‹å¾Œæˆ‘åƒè€ƒäº†[é€™å€‹å½±ç‰‡](https://www.youtube.com/watch?v=gnupOrSEikQ)ã€ä¸¦åˆ—å‡ºäº†ä¸‹é¢å¹¾é …æˆ‘éœ€è¦çš„åŠŸèƒ½ï¼Œé‚„æœ‰å°æ‡‰åˆ°æˆ‘æœ€å¾Œæ‰¾åˆ°çš„å¤–æ›ï¼š

|æƒ³è¦çš„åŠŸèƒ½|å¤–æ›æœ¬äºº|
|-----------------------|---------|
|Tabnine(Auto Complete)|[Coc](https://github.com/neoclide/coc.nvim.git) è£¡çš„ Tabnine|
|Ctrl / å–®è¡Œ/å¤šè¡Œè¨»è§£|[NERDCommenter](https://github.com/preservim/nerdcommenter.git)|
|Ctrl P å°‹æ‰¾æª”æ¡ˆ|[CtrlP](https://github.com/ctrlpvim/ctrlp.vim.git)|
|File tree viewer|[NERDTree](https://github.com/preservim/nerdtree.git)<br>[Devicons](https://github.com/ryanoasis/vim-devicons.git)|
|Git status|[Git Gutter](https://github.com/airblade/vim-gitgutter.git)|
|å¥½çœ‹çš„ä¸»é¡Œ|[Airline](https://github.com/vim-airline/vim-airline.git)(å„ªåŒ–åŸºæœ¬ä»‹é¢)<br>[VScode Horizon Theme](https://github.com/ntk148v/vim-horizon.git)|

è€Œæˆ‘åœ¨ Vim ä¸Šä½¿ç”¨çš„å¤–æ›ç®¡ç†å·¥å…·æ˜¯ Pathogenï¼Œå› ç‚ºåœ¨å®‰è£æ™‚åªè¦æŠŠå¤–æ›çš„ github repo clone åˆ° `autoload/` çš„è³‡æ–™å¤¾è£¡å°±å¥½ï¼Œä¸ç”¨åœ¨ `.vimrc` è£¡æ–°å¢åˆå§‹åŒ–çš„è¨­å®šï¼ˆç•¶ç„¶å¦‚æœè¦æ”¹å¤–æ›åˆå§‹è¨­å®šé‚„æ˜¯å¾—ä¿®æ”¹ï¼‰è®“æˆ‘è¦ºå¾—å¾ˆæ–¹ä¾¿ä¹Ÿå¾ˆå¥½ç†è§£ã€‚

## å…¶ä»–è¨­å®š
### Keymapping

ä¸å¾—ä¸èªª Keymapping çœŸçš„æ˜¯å¾ˆæ–¹ä¾¿çš„è¨­å®šï¼Œè®“æˆ‘å¯ä»¥å®Œå…¨æŠŠåœ¨ VScode ä¸Šç¿’æ…£çš„å¿«é€Ÿéµç›´æ¥æ¬éä¾†ç”¨ï¼Œé€™ä¹Ÿæ˜¯ä¸€äº›å¤–æ›ï¼ˆåƒ `CtrlP`ï¼‰çš„é‹ä½œåŸºç¤ã€‚èˆ‰ä¾‹ä¾†èªª `nnoremap <Right> <Nop>` çš„æ„æ€æ˜¯ï¼Œåœ¨ Normal mode ä¸‹ï¼Œ`<Right>` key è¦å°æ‡‰æˆ `<Nop>` ä¹Ÿå°±æ˜¯æ²’æœ‰å‹•ä½œï¼ˆç•¶åˆåœ¨å­¸åŸºæœ¬æ“ä½œæ™‚ç‚ºäº†å¼·è¿«è‡ªå·±è¨˜å¾—è€Œè¨­å®šçš„ï¼‰ï¼Œè€Œå¦‚æœè¦æ”¹åœ¨ Visual mode çš„ keymapping çš„è©±åªéœ€è¦æŠŠ `nnoremap` æ”¹æˆ `vnoremap` å°±è¡Œäº†ï¼Œå…¶ä¸­çš„ `nore` ä»£è¡¨çš„å‰‡æ˜¯ no recursiveï¼Œé¿å…ç„¡çª®è¿´åœˆã€‚

é€™é‚Šæˆ‘ä¸»è¦æ˜¯è¨­å®šè¼¸å…¥ `(` `[` `'` `"` å°±æœƒè‡ªå‹•è·³å‡º `)` `]` `'` `"`ï¼Œé‚„æœ‰è¼¸å…¥ `{` å¾Œå¦‚æœæ¥çš„æ˜¯ `<Enter>` å°±è‡ªå‹•è£œä¸Š `}`ï¼Œ`{{` è‡ªå‹•ç”Ÿæˆæˆå°çš„å¤§æ‹¬è™Ÿ `{}`

```vim
inoremap ( ()<Esc>i
inoremap " ""<Esc>i
inoremap ' ''<Esc>i
inoremap [ []<Esc>i

inoremap {<CR> {<CR>}<Esc>ko
inoremap {{ {}<ESC>i
```

### å¤–æ›è¨­å®š
æ¥ä¸‹ä¾†å°±æ˜¯æˆ‘å°å¤–æ›è¨­å®šçš„ keymappingï¼Œé€™é‚ŠçœŸçš„è »è¤‡é›œçš„ï¼ŒæŸ¥äº†ä¸€å †è³‡æ–™æ‰æŠŠé€™äº›è¨­å®šæå¥½ğŸ¥²

#### NERDTree
1. `Ctrl E` é–‹å•Ÿ NERDTree
2. å¿½ç•¥ `node_modules/`
3. åœ¨ NERDTree highlight ç•¶å‰é–‹å•Ÿçš„æª”æ¡ˆ

```vim
nnoremap <C-E> :NERDTreeToggle<CR>
let g:NERDTreeIgnore = ['^node_modules$']
autocmd BufRead * call SyncTree()
```

#### NERDTree + CtrlP Sync
åœ¨æŸ¥å¤–æ›è¨­å®šæ™‚çœ‹åˆ°äº†ä¸€å€‹å¾ˆé…·çš„åŠŸèƒ½ï¼Œå°±æ˜¯ç•¶ NERDTree æ˜¯é–‹å•Ÿæ™‚åŸ·è¡Œ CtrlP å°‹æ‰¾æª”æ¡ˆï¼Œç•¶é¸å–æª”æ¡ˆé–‹å•Ÿå¾ŒåŒæ­¥æ›´æ–° NERDTree çš„å±•é–‹çµæ§‹ï¼Œé€™å€‹è¡Œç‚ºè·Ÿ VScode è£¡çš„ Ctrl P è¡Œç‚ºå¹¾ä¹æ˜¯ä¸€æ¨¡ä¸€æ¨£äº†ï¼ä¸éå› ç‚ºåŸä½œè€…å¯«çš„ `IsNERDTreeOpen` æœ‰é»å•é¡Œï¼Œæ²’è¾¦æ³•æ­£ç¢ºåˆ¤æ–· NERDTree æ˜¯å¦é–‹å•Ÿï¼Œå¾Œä¾†ä¸Šç¶²æŸ¥äº†ä¸€å †è³‡æ–™æ‰æ”¹æˆä¸‹é¢çš„çµæœï¼ˆè¨»è§£çš„éƒ¨åˆ†æ˜¯åŸä½œè€…çš„ codeï¼‰ï¼Œä¸éå› ç‚ºæ˜¯å¾ˆä¹…ä»¥å‰æ”¹çš„ï¼Œæˆ‘ä¹Ÿæ²’æœ‰ç•™é€£çµï¼Œåªè¨˜å¾—æ˜¯åœ¨ StackExchange ä¸Šçœ‹åˆ°çš„ğŸ˜¢ï¼ˆå†ä¸å¯«ç´€éŒ„å•Šï¼‰

```vim
" CtrlP + NERDTree
" sync open file with NERDTree
" Check if NERDTree is open or active
function! IsNERDTreeOpen()
  return exists("g:NERDTree") && g:NERDTree.IsOpen()
  "exists("t:NERDTreeBufName") && (bufwinnr(t:NERDTreeBufName) != -1)
endfunction

" Call NERDTreeFind iff NERDTree is active, current window contains a modifiable
" file, and we're not in vimdiff
function! SyncTree()
  if &modifiable && IsNERDTreeOpen() && strlen(expand('%')) > 0 && !&diff
    NERDTreeFind
    wincmd p
  endif
endfunction
```

#### ä¸»é¡Œè¨­å®š
é€™é‚Šé¸ç”¨äº†å¾ VScode æ¬éä¾†çš„ Horizon themeï¼Œæ‰€ä»¥ terminal åŸç”Ÿçš„è‰²å½©å¯èƒ½æœƒä¸å¤ ç”¨ï¼Œå› æ­¤æœƒéœ€è¦å°‡ Vim è¨­å®šç‚º true colorï¼Œä¸¦ä¸”ä½¿ç”¨ iTerm æ‰èƒ½é¡¯ç¤ºèˆ‡åœ¨ VScode ä¸€æ¨£çš„é¡è‰²ã€‚

```vim
" Colorscheme
set t_Co=256
colorscheme horizon
" Set true colors
set termguicolors
let &t_8f = "\e[38;2;%lu;%lu;%lum"
let &t_8b = "\e[48;2;%lu;%lu;%lum"
let g:lightline = {'colorscheme' : 'horizon'}
```

### Auto Command
1. åœ¨å­˜æª”å‰è‡ªå‹•åˆªé™¤ç©ºç™½éµï¼ˆRubocop æœƒæŠ“ğŸ˜€ğŸ”ªï¼‰
2. é–‹å•Ÿ Vim å¾Œè‡ªå‹•é–‹å•Ÿ NERDTree

```vim
" Autocmd: remove space before save
au BufWritePre * :%s/\s\+$//e
" Autocmd: Open NERDTree while opening vim
au VimEnter * NERDTree
```

åŸºæœ¬ä¸Šé€™äº›å°±æ˜¯æˆ‘çš„ Vim è¨­å®šæ¯”è¼ƒç‰¹åˆ¥çš„åœ°æ–¹ï¼Œå‰å‰å¾Œå¾Œå¤§æ¦‚èŠ±äº†ç´„ä¸€å€‹æœˆçš„æ™‚é–“ä¸Šæ‰‹ä¸¦ä¸”è¨­å®šå®Œæˆï¼Œåœ¨ç†Ÿæ‚‰ Vim ä¹‹å¾ŒçœŸçš„æœƒè¦ºå¾—ä»‹é¢ä¹¾æ·¨å¾ˆå¤šï¼Œä¸æœƒè·³å¾ˆå¤šè¦æ›´æ–°å¤–æ›ã€æ›´æ–° IDE ä¹‹é¡é›œä¸ƒé›œå…«çš„é€šçŸ¥ï¼Œè€Œä¸”å»åˆ¥çš„åœ°æ–¹ç·¨è¼¯åˆ°è¦å­˜æª”æ™‚çœŸçš„æœƒç¿’æ…£è¦æ‰“ `:w` lol

<font color="grey" style="font-size: 24px">Reference</font>
* [å³å°‡å¤±å‚³çš„å¤è€æŠ€è— Vim](https://www.youtube.com/watch?v=LQVriYE3kxk&list=PLBd8JGCAcUAH56L2CYF7SmWJYKwHQYUDI)
* [vgod çš„ vimrc](https://github.com/vgod/vimrc)
* [vgod's vim cheatsheet](https://blog.vgod.tw/2009/12/08/vim-cheat-sheet-for-programmers/)
* [How to Configure Vim like VSCode](https://www.youtube.com/watch?v=gnupOrSEikQ)
* [Coc](https://github.com/neoclide/coc.nvim.git)
* [NERDCommenter](https://github.com/preservim/nerdcommenter.git)
* [CtrlP](https://github.com/ctrlpvim/ctrlp.vim.git)
* [NERDTree](https://github.com/preservim/nerdtree.git)
* [Devicons](https://github.com/ryanoasis/vim-devicons.git)
* [Git Gutter](https://github.com/airblade/vim-gitgutter.git)
* [Airline](https://github.com/vim-airline/vim-airline.git)
* [VScode Horizon Theme](https://github.com/ntk148v/vim-horizon.git)
